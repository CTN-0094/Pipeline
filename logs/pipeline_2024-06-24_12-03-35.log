2024-06-24 12:03:35 - INFO - -------------------------------------------
2024-06-24 12:03:35 - INFO - Logging setup complete - starting pipeline.
2024-06-24 12:03:35 - INFO - -------------------------------------------
2024-06-24 12:03:48 - INFO - Selected demographic feature: 'RaceEth'
2024-06-24 12:03:48 - INFO - Races: NHW
2024-06-24 12:03:48 - INFO - Sample sizes: 1000
2024-06-24 12:03:50 - INFO - Datasets loaded successfully.
2024-06-24 12:03:50 - INFO - Selected outcome column 'Rs_johnson_1992' successfully.
2024-06-24 12:03:50 - INFO - Starting merge of dataset and selected outcome...
2024-06-24 12:03:50 - INFO - Dataset merged successfully with selected outcome.
2024-06-24 12:03:50 - INFO - Created demographic subset with feature 'RaceEth'.
2024-06-24 12:03:50 - INFO - ---------------------------------
2024-06-24 12:03:50 - INFO - PRE-PROCESSING STAGE STARTING...
2024-06-24 12:03:50 - INFO - ---------------------------------
2024-06-24 12:03:50 - INFO - Dropped initial columns: ['pain_when', 'is_smoker', 'per_day', 'max', 'amount', 'depression', 'anxiety', 'schizophrenia', 'max', 'amount', 'cocaine_inject_days', 'speedball_inject_days', 'opioid_inject_days', 'speed_inject_days', 'UDS_Alcohol_Count', 'UDS_Mdma/Hallucinogen_Count']
2024-06-24 12:03:50 - INFO - Converted Yes/No to binary.
2024-06-24 12:03:50 - INFO - Processed TLFB columns with specified columns: ['TLFB_Alcohol_Count', 'TLFB_Amphetamine_Count', 'TLFB_Cocaine_Count', 'TLFB_Heroin_Count', 'TLFB_Benzodiazepine_Count', 'TLFB_Opioid_Count', 'TLFB_THC_Count', 'TLFB_Methadone_Count', 'TLFB_Buprenorphine_Count']
2024-06-24 12:03:50 - INFO - Calculated behavioral columns.
2024-06-24 12:03:50 - INFO - Moved 'Rs_johnson_1992' column to the end.
2024-06-24 12:03:50 - INFO - Dropped initial columns: ['msm_npt', 'msm_frq', 'txx_prt']
2024-06-24 12:03:50 - INFO - transform_data_with_nan_handling success
2024-06-24 12:03:50 - INFO - Renamed columns according to the mapping.
2024-06-24 12:03:50 - INFO - Transformed NaN to 0 for binary columns.
2024-06-24 12:03:50 - INFO - Transformed and renamed 'heroin_inject_days' column to 'rbsivheroin'.
2024-06-24 12:03:50 - INFO - Filled NaN with 0 for 'ftnd' column.
2024-06-24 12:03:50 - INFO - Dropped additional columns: ['rbs_iv_days', 'race', 'RBS_cocaine_Days', 'RBS_heroin_Days', 'RBS_opioid_Days', 'RBS_speed_Days', 'RBS_speedball_Days']
2024-06-24 12:03:50 - INFO - Converted UDS drug counts to binary.
2024-06-24 12:03:50 - INFO - ------------------------------
2024-06-24 12:03:50 - INFO - PRE-PROCESSING STAGE COMPLETED
2024-06-24 12:03:50 - INFO - ------------------------------
2024-06-24 12:03:50 - INFO - -----------------------------
2024-06-24 12:03:50 - INFO - TRAIN MODEL STAGE STARTING...
2024-06-24 12:03:50 - INFO - -----------------------------
2024-06-24 12:03:50 - INFO - Scaling features and applying LASSO for feature selection...
2024-06-24 12:03:53 - INFO - Selected features (including required): ['who', 'age', 'unemployed', 'unstableliving', 'education', 'marital', 'is_female', 'UDS_Amphetamine_Count', 'UDS_Benzodiazepine_Count', 'UDS_Buprenorphine_Count', 'UDS_Cocaine_Count', 'UDS_Methadone_Count', 'UDS_Opioid_Count', 'UDS_Sedatives_Count', 'UDS_Thc_Count', 'pain', 'has_schizophrenia', 'has_major_dep', 'has_bipolar', 'has_anx_pan', 'has_brain_damage', 'has_epilepsy', 'has_alcol_dx', 'has_amphetamines_dx', 'has_cannabis_dx', 'has_cocaine_dx', 'has_sedatives_dx', 'ftnd', 'XTRT', 'shared', 'rbsivheroin', 'TLFB_Alcohol_Count', 'TLFB_Amphetamine_Count', 'TLFB_Benzodiazepine_Count', 'TLFB_Buprenorphine_Count', 'TLFB_Cocaine_Count', 'TLFB_Heroin_Count', 'TLFB_Methadone_Count', 'TLFB_Opioid_Count', 'TLFB_THC_Count', 'TLFB_Other', 'Homosexual_Behavior', 'Non_monogamous_Relationships']
2024-06-24 12:03:53 - INFO - Fitting logistic regression model with the selected features...
2024-06-24 12:03:54 - INFO - Model training completed successfully.
2024-06-24 12:03:54 - INFO - Calculating the dynamic threshold based on the proportion of positive outcomes...
2024-06-24 12:03:54 - INFO - Ratio of 1s to 0s in the outcome variable: 0.86 : 0.14
2024-06-24 12:03:54 - INFO - Dynamic threshold set to: 0.86
2024-06-24 12:03:54 - INFO - Model trained and saved successfully.
2024-06-24 12:03:54 - INFO - ---------------------------
2024-06-24 12:03:54 - INFO - TRAIN MODEL STAGE COMPLETED
2024-06-24 12:03:54 - INFO - ---------------------------
2024-06-24 12:03:54 - INFO - --------------------------------
2024-06-24 12:03:54 - INFO - EVALUATE MODEL STAGE STARTING...
2024-06-24 12:03:54 - INFO - --------------------------------
2024-06-24 12:03:54 - INFO - ROC AUC Score: 0.7218604651162791
2024-06-24 12:03:54 - INFO - Confusion Matrix: 
[[ 14  21]
 [ 42 173]]
2024-06-24 12:03:54 - INFO - Precision: 0.8917525773195877
2024-06-24 12:03:54 - INFO - Recall: 0.8046511627906977
2024-06-24 12:03:54 - INFO - ------------------------------
2024-06-24 12:03:54 - INFO - EVALUATE MODEL STAGE COMPLETED
2024-06-24 12:03:54 - INFO - ------------------------------
2024-06-24 12:03:54 - INFO - ------------------
2024-06-24 12:03:54 - INFO - PIPELINE COMPLETED
2024-06-24 12:03:54 - INFO - ------------------
